from bs4 import BeautifulSoup
import requests
import yfinance as yf
import pandas as pd
from urllib.parse import urljoin
import os
import torch
import numpy as np
import time
from newspaper import Article

# Semantic model
from transformers import AutoTokenizer, AutoModelForSequenceClassification

script_dir = os.path.dirname(os.path.abspath(__file__))
nasdaq_txt_path = os.path.join(script_dir, 'nasdaq.txt')

# # Load NASDAQ tickers from the "nasdaq.txt" file
# with open(nasdaq_txt_path, 'r') as file:
#     nasdaq_ticker_list = file.read().splitlines()

# # Create a set of NASDAQ tickers for efficient lookup
# nasdaq_ticker_set = set(nasdaq_ticker_list)

nasdaq_ticker_set = {'A','AA','AACG','AACI','AACT','AADI','AAIC','AAL','AAMC','AAME','AAN','AAOI','AAON','AAP','AAPL','AAT','AAU','AB','ABAT','ABBV','ABCB','ABCL','ABCM','ABEO','ABEV','ABG','ABIO','ABL','ABLV','ABM','ABNB','ABOS','ABR','ABSI','ABT','ABTS','ABUS','ABVC','ABVX','AC','ACA','ACAB','ACAC','ACAD','ACAH','ACAX','ACB','ACBA','ACCD','ACCO','ACDC','ACEL','ACET','ACGL','ACHC','ACHL','ACHR','ACHV','ACI','ACIC','ACIU','ACIW','ACLS','ACLX','ACM','ACMR','ACN','ACNB','ACNT','ACON','ACOR','ACR','ACRE','ACRO','ACRS','ACRV','ACRX','ACST','ACT','ACTG','ACU','ACVA','ACXP','ADAG','ADAP','ADBE','ADC','ADCT','ADD','ADEA','ADES','ADEX','ADI','ADIL','ADM','ADMA','ADN','ADNT','ADOC','ADP','ADPT','ADRT','ADSE','ADSK','ADT','ADTH','ADTN','ADTX','ADUS','ADV','ADVM','ADXN','AE','AEAE','AEE','AEG','AEHL','AEHR','AEI','AEIS','AEL','AEM','AEMD','AENT','AENZ','AEO','AEON','AEP','AER','AERT','AES','AESI','AEVA','AEY','AEYE','AEZS','AFAR','AFBI','AFCG','AFG','AFIB','AFL','AFMD','AFRI','AFRM','AFYA','AG','AGAE','AGBA','AGCO','AGE','AGEN','AGFY','AGI','AGIL','AGIO','AGL','AGLE','AGM','AGM.A','AGMH','AGNC','AGO','AGR','AGRI','AGRO','AGRX','AGS','AGTI','AGX','AGYS','AHCO','AHG','AHH','AHI','AHT','AI','AIB','AIG','AIH','AIHS','AIM','AIMAU','AIMD','AIN','AINC','AIP','AIR','AIRC','AIRE','AIRG','AIRI','AIRS','AIRT','AIT','AITR','AIU','AIV','AIXI','AIZ','AJG','AJX','AKA','AKAM','AKAN','AKBA','AKLI','AKO.A','AKO.B','AKR','AKRO','AKTS','AKTX','AKYA','AL','ALAR','ALB','ALBT','ALC','ALCC','ALCO','ALCY','ALDX','ALE','ALEC','ALEX','ALG','ALGM','ALGN','ALGS','ALGT','ALHC','ALIM','ALIT','ALK','ALKS','ALKT','ALL','ALLE','ALLG','ALLK','ALLO','ALLR','ALLT','ALLY','ALNT','ALNY','ALOT','ALPN','ALPP','ALRM','ALRN','ALRS','ALSA','ALSN','ALT','ALTG','ALTI','ALTO','ALTR','ALTU','ALUR','ALV','ALVO','ALVR','ALX','ALXO','ALYA','ALZN','AM','AMAL','AMAM','AMAT','AMBA','AMBC','AMBI','AMBO','AMBP','AMC','AMCR','AMCX','AMD','AME','AMED','AMEH','AMG','AMGN','AMH','AMK','AMKR','AMLI','AMLX','AMN','AMNB','AMP','AMPE','AMPG','AMPH','AMPL','AMPS','AMPX','AMPY','AMR','AMRC','AMRK','AMRN','AMRX','AMS','AMSC','AMSF','AMST','AMSWA','AMT','AMTB','AMTD','AMTI','AMTX','AMWD','AMWL','AMX','AMZN','AN','ANAB','ANDE','ANEB','ANET','ANF','ANGH','ANGI','ANGO','ANIK','ANIP','ANIX','ANL','ANNX','ANSC','ANSS','ANTE','ANTX','ANVS','ANY','AOGO','AOMR','AON','AONC','AORT','AOS','AOSL','AOUT','AP','APA','APAC','APAM','APCA','APCX','APD','APDN','APEI','APG','APGB','APGE','APH','API','APLD','APLE','APLM','APLS','APLT','APM','APO','APOG','APP','APPF','APPN','APPS','APRE','APT','APTM','APTO','APTV','APVO','APWC','APXI','APYX','AQB','AQMS','AQN','AQST','AQU','AR','ARAV','ARAY','ARBB','ARBE','ARBK','ARC','ARCB','ARCC','ARCE','ARCH','ARCO','ARCT','ARDX','ARE','AREB','AREC','AREN','ARES','ARGX','ARHS','ARI','ARIS','ARIZ','ARKO','ARKR','ARL','ARLO','ARLP','ARM','ARMK','ARMN','ARMP','AROC','AROW','ARQQ','ARQT','ARR','ARRW','ARRY','ARTL','ARTNA','ARTW','ARVL','ARVN','ARW','ARWR','ARYD','ASA','ASAI','ASAN','ASB','ASC','ASCA','ASCB','ASGN','ASH','ASIX','ASLE','ASLN','ASM','ASMB','ASML','ASND','ASNS','ASO','ASPI','ASPN','ASPS','ASR','ASRT','ASRV','ASST','ASTC','ASTE','ASTI','ASTL','ASTR','ASTS','ASUR','ASX','ASXC','ASYS','ATAI','ATAK','ATAT','ATEC','ATEK','ATEN','ATER','ATEX','ATGE','ATGL','ATHA','ATHE','ATHM','ATI','ATIF','ATIP','ATKR','ATLC','ATLO','ATLX','ATMC','ATMU','ATMV','ATNF','ATNI','ATNM','ATO','ATOM','ATOS','ATPC','ATR','ATRA','ATRC','ATRI','ATRO','ATS','ATSG','ATUS','ATXG','ATXI','ATXS','AU','AUB','AUBN','AUDC','AUGX','AUID','AULT','AUMN','AUPH','AUR','AURA','AUST','AUTL','AUUD','AUVI','AVA','AVAH','AVAL','AVAV','AVB','AVD','AVDL','AVDX','AVGO','AVGR','AVHI','AVIR','AVNS','AVNT','AVNW','AVO','AVPT','AVRO','AVT','AVTA','AVTE','AVTR','AVTX','AVXL','AVY','AWH','AWI','AWIN','AWK','AWR','AWRE','AWX','AX','AXDX','AXGN','AXL','AXLA','AXNX','AXON','AXP','AXR','AXS','AXSM','AXTA','AXTI','AY','AYI','AYRO','AYTU','AYX','AZ','AZEK','AZN','AZO','AZPN','AZTA','AZTR','AZUL','AZZ','B','BA','BABA','BAC','BACA','BACK','BAER','BAFN','BAH','BAK','BALL','BALY','BAM','BANC','BAND','BANF','BANL','BANR','BANX','BAOS','BAP','BARK','BASE','BATL','BATRA','BATRK','BAX','BB','BBAI','BBAR','BBCP','BBD','BBDC','BBDO','BBGI','BBIO','BBLG','BBSI','BBU','BBUC','BBVA','BBW','BBWI','BBY','BC','BCAB','BCAL','BCAN','BCBP','BCC','BCDA','BCE','BCEL','BCH','BCLI','BCML','BCO','BCOV','BCOW','BCPC','BCRX','BCS','BCSA','BCSF','BCTX','BCYC','BDC','BDL','BDN','BDRX','BDSX','BDTX','BDX','BE','BEAM','BEAT','BECN','BEDU','BEEM','BEEP','BEKE','BELFA','BELFB','BEN','BENF','BEP','BEPC','BERY','BEST','BETR','BETS','BF.A','BF.B','BFAC','BFAM','BFC','BFH','BFI','BFIN','BFLY','BFRG','BFRI','BFS','BFST','BFX','BG','BGC','BGFV','BGI','BGNE','BGS','BGSF','BGXX','BH','BH.A','BHAC','BHAT','BHB','BHC','BHE','BHF','BHG','BHIL','BHLB','BHM','BHP','BHR','BHRB','BHVN','BIAF','BIDU','BIG','BIGC','BIIB','BILI','BILL','BIMI','BIO','BIOL','BIOR','BIOX','BIP','BIPC','BIRD','BIRK','BITE','BITF','BIVI','BJ','BJDX','BJRI','BK','BKCC','BKD','BKE','BKH','BKKT','BKNG','BKR','BKSY','BKTI','BKU','BKYI','BL','BLAC','BLBD','BLBX','BLCO','BLD','BLDE','BLDP','BLDR','BLEU','BLFS','BLFY','BLIN','BLK','BLKB','BLMN','BLND','BLNK','BLRX','BLTE','BLUA','BLUE','BLX','BLZE','BMA','BMAC','BMBL','BMEA','BMI','BMO','BMR','BMRA','BMRC','BMRN','BMTX','BMY','BN','BNED','BNGO','BNIX','BNL','BNOX','BNR','BNRE','BNRG','BNS','BNTC','BNTX','BOC','BOCN','BODY','BOF','BOH','BOKF','BOLT','BON','BOOM','BOOT','BORR','BOSC','BOTJ','BOWL','BOWN','BOX','BOXL','BP','BPMC','BPOP','BPRN','BPT','BPTH','BPTS','BQ','BR','BRAC','BRAG','BRBR','BRBS','BRC','BRCC','BRD','BRDG','BREA','BREZ','BRFH','BRFS','BRID','BRK.A','BRK.B','BRKH','BRKL','BRKR','BRLI','BRLT','BRN','BRNS','BRO','BROG','BROS','BRP','BRSH','BRSP','BRT','BRTX','BRX','BRY','BRZE','BSAC','BSBK','BSBR','BSET','BSFC','BSGM','BSIG','BSM','BSQR','BSRR','BSVN','BSX','BSY','BTAI','BTBD','BTBT','BTCM','BTCS','BTCT','BTCY','BTDR','BTE','BTG','BTI','BTM','BTMD','BTOG','BTTR','BTTX','BTU','BUD','BUJA','BUR','BURL','BURU','BUSE','BV','BVH','BVN','BVS','BW','BWA','BWAQ','BWAY','BWB','BWEN','BWFG','BWMN','BWMX','BWV','BWXT','BX','BXC','BXMT','BXP','BY','BYD','BYFC','BYN','BYND','BYNO','BYON','BYRN','BYSI','BYTS','BYU','BZ','BZFD','BZH','BZUN','C','CAAP','CAAS','CABA','CABO','CAC','CACC','CACI','CACO','CADE','CADL','CAE','CAG','CAH','CAKE','CAL','CALB','CALM','CALT','CALX','CAMP','CAMT','CAN','CANF','CANG','CANO','CAPL','CAPR','CAPT','CAR','CARA','CARE','CARG','CARM','CARR','CARS','CART','CARV','CASA','CASH','CASI','CASS','CASY','CAT','CATC','CATO','CATX','CATY','CAUD','CAVA','CB','CBAN','CBAT','CBAY','CBD','CBFV','CBL','CBNK','CBOE','CBRE','CBRG','CBRL','CBSH','CBT','CBU','CBUS','CBZ','CC','CCAP','CCB','CCBG','CCCC','CCCS','CCEL','CCEP','CCG','CCI','CCJ','CCK','CCL','CCLD','CCLP','CCM','CCNE','CCO','CCOI','CCRD','CCRN','CCS','CCSI','CCTS','CCU','CCVI','CD','CDAQ','CDAY','CDE','CDIO','CDLX','CDMO','CDNA','CDNS','CDP','CDRE','CDRO','CDT','CDTX','CDW','CDXC','CDXS','CDZI','CE','CEAD','CECO','CEG','CEI','CEIX','CELC','CELH','CELU','CELZ','CENN','CENT','CENTA','CENX','CEPU','CEQP','CERE','CERS','CERT','CET','CETU','CETX','CEVA','CF','CFB','CFBK','CFFE','CFFI','CFFN','CFFS','CFG','CFIV','CFLT','CFR','CFSB','CG','CGA','CGAU','CGBD','CGC','CGEM','CGEN','CGNT','CGNX','CGTX','CHAA','CHCI','CHCO','CHCT','CHD','CHDN','CHE','CHEA','CHEF','CHEK','CHGG','CHH','CHK','CHKP','CHMG','CHMI','CHNR','CHPT','CHR','CHRD','CHRS','CHRW','CHS','CHSN','CHT','CHTR','CHUY','CHWY','CHX','CI','CIA','CIB','CIEN','CIFR','CIG','CIGI','CIM','CINF','CING','CINT','CIO','CION','CISO','CISS','CITE','CIVB','CIVI','CIX','CIZN','CJET','CJJD','CKPT','CKX','CL','CLAR','CLAY','CLB','CLBK','CLBT','CLCO','CLDI','CLDT','CLDX','CLEU','CLF','CLFD','CLGN','CLH','CLIN','CLIR','CLLS','CLMB','CLMT','CLNE','CLNN','CLOE','CLOV','CLPR','CLPS','CLPT','CLRB','CLRC','CLRO','CLS','CLSD','CLSK','CLST','CLVR','CLVT','CLW','CLWT','CLX','CM','CMA','CMAX','CMBM','CMC','CMCA','CMCL','CMCM','CMCO','CMCSA','CMCT','CME','CMG','CMI','CMLS','CMMB','CMND','CMP','CMPO','CMPR','CMPS','CMPX','CMRE','CMRX','CMS','CMT','CMTG','CMTL','CNA','CNC','CNDA','CNDB','CNDT','CNET','CNEY','CNF','CNFR','CNGL','CNHI','CNI','CNK','CNM','CNMD','CNNE','CNO','CNOB','CNP','CNQ','CNS','CNSL','CNSP','CNTA','CNTB','CNTG','CNTX','CNTY','CNVS','CNX','CNXA','CNXC','CNXN','COCH','COCO','COCP','CODA','CODI','CODX','COE','COEP','COF','COFS','COGT','COHN','COHR','COHU','COIN','COKE','COLB','COLD','COLL','COLM','COMM','COMP','COMS','CONN','CONX','COO','COOK','COOL','COOP','COP','COR','CORR','CORT','COSM','COST','COTY','COUR','COYA','CP','CPA','CPAC','CPB','CPBI','CPE','CPF','CPG','CPHC','CPHI','CPIX','CPK','CPLP','CPNG','CPOP','CPRI','CPRT','CPRX','CPS','CPSH','CPSI','CPSS','CPT','CPTK','CPTN','CQP','CR','CRAI','CRBG','CRBP','CRBU','CRC','CRCT','CRD.A','CRD.B','CRDF','CRDL','CRDO','CREG','CRESY','CREV','CREX','CRGE','CRGO','CRGX','CRGY','CRH','CRI','CRIS','CRK','CRKN','CRL','CRM','CRMD','CRMT','CRNC','CRNT','CRNX','CRON','CROX','CRS','CRSP','CRSR','CRT','CRTO','CRUS','CRVL','CRVO','CRVS','CRWD','CRWS','CSAN','CSBR','CSCO','CSGP','CSGS','CSIQ','CSL','CSLM','CSLR','CSPI','CSR','CSSE','CSTA','CSTE','CSTL','CSTM','CSTR','CSV','CSWC','CSWI','CSX','CTAS','CTBI','CTCX','CTG','CTGO','CTHR','CTKB','CTLP','CTLT','CTM','CTMX','CTNT','CTO','CTOS','CTRA','CTRE','CTRM','CTRN','CTS','CTSH','CTSO','CTV','CTVA','CTXR','CUBE','CUBI','CUE','CUEN','CUK','CULL','CULP','CURI','CURO','CURV','CUTR','CUZ','CVAC','CVBF','CVCO','CVCY','CVE','CVEO','CVGI','CVGW','CVI','CVII','CVKD','CVLG','CVLT','CVLY','CVM','CVNA','CVR','CVRX','CVS','CVU','CVV','CVX','CW','CWAN','CWBC','CWBR','CWCO','CWD','CWEN','CWEN.A','CWH','CWK','CWST','CWT','CX','CXAI','CXDO','CXM','CXT','CXW','CYAN','CYBN','CYBR','CYCC','CYCN','CYD','CYH','CYN','CYRX','CYT','CYTH','CYTK','CYTO','CZFS','CZNC','CZOO','CZR','CZWI','D','DAC','DADA','DAIO','DAKT','DAL','DALN','DAN','DAO','DAR','DARE','DASH','DATS','DAVA','DAVE','DAWN','DB','DBD','DBGI','DBI','DBRG','DBVT','DBX','DC','DCBO','DCFC','DCGO','DCI','DCO','DCOM','DCPH','DCTH','DD','DDC','DDD','DDI','DDL','DDOG','DDS','DE','DEA','DECA','DECK','DEI','DELL','DENN','DEO','DERM','DESP','DFH','DFIN','DFLI','DFS','DG','DGHI','DGICA','DGICB','DGII','DGLY','DGX','DH','DHAC','DHC','DHCA','DHI','DHIL','DHR','DHT','DHX','DIBS','DIN','DINO','DIOD','DIS','DISA','DISH','DIST','DIT','DJCO','DK','DKL','DKNG','DKS','DLA','DLB','DLHC','DLNG','DLO','DLPN','DLR','DLTH','DLTR','DLX','DM','DMAC','DMAQ','DMK','DMLP','DMRC','DMTK','DMYY','DNA','DNB','DNLI','DNMR','DNN','DNOW','DNTH','DNUT','DO','DOC','DOCN','DOCS','DOCU','DOGZ','DOLE','DOMA','DOMH','DOMO','DOOO','DOOR','DORM','DOUG','DOV','DOW','DOX','DOYU','DPCS','DPRO','DPSI','DPZ','DQ','DRCT','DRD','DRH','DRI','DRIO','DRMA','DRQ','DRRX','DRS','DRTS','DRUG','DRVN','DSAQ','DSGN','DSGR','DSGX','DSKE','DSP','DSS','DSWL','DSX','DT','DTC','DTCK','DTE','DTI','DTIL','DTM','DTSS','DTST','DUET','DUK','DUNE','DUO','DUOL','DUOT','DV','DVA','DVAX','DVN','DWAC','DWSN','DX','DXC','DXCM','DXF','DXLG','DXPE','DXR','DXYN','DY','DYAI','DYN','DYNT','DZSI','E','EA','EAC','EAF','EAR','EARN','EAST','EAT','EB','EBAY','EBC','EBF','EBIX','EBMT','EBON','EBR','EBS','EBTC','EC','ECBK','ECC','ECL','ECOR','ECPG','ECVT','ECX','ED','EDAP','EDBL','EDIT','EDN','EDR','EDRY','EDSA','EDTK','EDU','EDUC','EE','EEFT','EEIQ','EEX','EFC','EFHT','EFOI','EFSC','EFSH','EFTR','EFX','EFXT','EG','EGAN','EGBN','EGGF','EGHT','EGIO','EGLE','EGO','EGOX','EGP','EGRX','EGY','EH','EHAB','EHC','EHTH','EIG','EIGR','EIX','EJH','EKSO','EL','ELA','ELAN','ELBM','ELDN','ELEV','ELF','ELIQ','ELLO','ELMD','ELME','ELP','ELS','ELSE','ELTK','ELTX','ELUT','ELV','ELVA','ELVN','ELWS','ELYM','EM','EMBC','EMCG','EME','EMKR','EML','EMLD','EMN','EMR','EMX','ENB','ENCP','ENER','ENFN','ENG','ENGN','ENIC','ENLC','ENLT','ENLV','ENOV','ENPH','ENR','ENS','ENSC','ENSG','ENSV','ENTA','ENTG','ENTX','ENV','ENVA','ENVB','ENVX','ENZ','EOG','EOLS','EOSE','EP','EPAC','EPAM','EPC','EPD','EPIX','EPM','EPOW','EPR','EPRT','EPSN','EQ','EQBK','EQC','EQH','EQIX','EQNR','EQR','EQS','EQT','EQX','ERAS','ERF','ERIC','ERIE','ERII','ERJ','ERNA','ERO','ES','ESAB','ESAC','ESBA','ESCA','ESE','ESEA','ESGL','ESGR','ESHA','ESI','ESLA','ESLT','ESMT','ESNT','ESOA','ESP','ESPR','ESQ','ESRT','ESS','ESSA','ESTA','ESTC','ET','ETAO','ETD','ETN','ETNB','ETON','ETR','ETRN','ETSY','ETWO','EU','EUDA','EURN','EVA','EVAX','EVBG','EVBN','EVC','EVCM','EVE','EVER','EVEX','EVGN','EVGO','EVGR','EVH','EVI','EVLO','EVLV','EVO','EVOK','EVR','EVRG','EVRI','EVTC','EVTL','EVTV','EW','EWBC','EWCZ','EWTX','EXAI','EXAS','EXC','EXEL','EXFY','EXK','EXLS','EXP','EXPD','EXPE','EXPI','EXPO','EXPR','EXR','EXTO','EXTR','EYE','EYEN','EYPT','EZFL','EZGO','EZPW','F','FA','FAF','FAMI','FANG','FANH','FARM','FARO','FAST','FAT','FATBB','FATE','FATH','FATP','FAZE','FBIN','FBIO','FBIZ','FBK','FBMS','FBNC','FBP','FBRT','FBRX','FBYD','FC','FCAP','FCBC','FCCO','FCEL','FCF','FCFS','FCN','FCNCA','FCNCO','FCPT','FCUV','FCX','FDBC','FDMT','FDP','FDS','FDUS','FDX','FE','FEAM','FEDU','FEIM','FELE','FEMY','FENC','FENG','FERG','FET','FEXD','FF','FFBC','FFIC','FFIE','FFIN','FFIV','FFNW','FFWM','FG','FGBI','FGEN','FGF','FGH','FGI','FHB','FHI','FHLT','FHN','FHTX','FI','FIAC','FIBK','FICO','FICV','FIGS','FIHL','FINV','FINW','FIP','FIS','FISI','FITB','FIVE','FIVN','FIX','FIXX','FIZZ','FKWL','FL','FLEX','FLFV','FLGC','FLGT','FLIC','FLJ','FLL','FLME','FLNC','FLNG','FLNT','FLO','FLR','FLS','FLT','FLUX','FLWS','FLXS','FLYW','FMAO','FMBH','FMC','FMNB','FMS','FMX','FN','FNA','FNB','FNCB','FNCH','FND','FNF','FNGR','FNKO','FNLC','FNV','FNVT','FNWB','FNWD','FOA','FOLD','FONR','FOR','FORA','FORD','FORL','FORM','FORR','FORTY','FOSL','FOUR','FOX','FOXA','FOXF','FOXO','FPAY','FPH','FPI','FR','FRAF','FRBA','FRD','FREE','FRES','FREY','FRGE','FRGT','FRHC','FRLA','FRLN','FRME','FRO','FROG','FRPH','FRPT','FRSH','FRST','FRSX','FRT','FRTX','FRXB','FRZA','FSBC','FSBW','FSEA','FSFG','FSI','FSK','FSLR','FSLY','FSM','FSP','FSR','FSRX','FSS','FSTR','FSV','FTAI','FTCH','FTCI','FTDR','FTEK','FTEL','FTFT','FTHM','FTI','FTII','FTK','FTLF','FTNT','FTRE','FTS','FTV','FUBO','FUL','FULC','FULT','FUN','FUNC','FURY','FUSB','FUSN','FUTU','FUV','FVCB','FVRR','FWBI','FWONA','FWRD','FWRG','FXNC','FYBR','G','GABC','GAIA','GAIN','GALT','GAMB','GAMC','GAME','GAN','GANX','GAQ','GASS','GATE','GATO','GATX','GAU','GB','GBBK','GBCI','GBDC','GBIO','GBLI','GBNH','GBNY','GBR','GBTG','GBX','GCBC','GCI','GCMG','GCO','GCT','GCTK','GD','GDC','GDDY','GDEN','GDEV','GDHG','GDNR','GDOT','GDRX','GDS','GDST','GDTC','GDYN','GE','GECC','GEF','GEF.B','GEG','GEHC','GEHI','GEL','GEN','GENC','GENE','GENI','GENK','GEO','GEOS','GERN','GES','GETR','GETY','GEVO','GFAI','GFF','GFI','GFL','GFR','GFS','GGAL','GGB','GGE','GGG','GGR','GH','GHC','GHG','GHI','GHIX','GHL','GHLD','GHM','GHRS','GHSI','GIA','GIB','GIC','GIFI','GIGM','GIII','GIL','GILD','GILT','GIPR','GIS','GKOS','GL','GLAC','GLAD','GLBE','GLBS','GLBZ','GLDD','GLDG','GLLI','GLMD','GLNG','GLOB','GLP','GLPG','GLPI','GLRE','GLSI','GLST','GLT','GLTO','GLUE','GLW','GLYC','GM','GMAB','GMBL','GMDA','GME','GMED','GMFI','GMGI','GMM','GMRE','GMS','GNE','GNFT','GNK','GNL','GNLN','GNLX','GNPX','GNRC','GNS','GNSS','GNTA','GNTX','GNTY','GNW','GO','GOCO','GODN','GOEV','GOGL','GOGO','GOL','GOLD','GOLF','GOOD','GOOG','GOOGL','GOOS','GORO','GOSS','GOTU','GOVX','GP','GPAC','GPAK','GPC','GPCR','GPI','GPK','GPMT','GPN','GPOR','GPP','GPRE','GPRK','GPRO','GPS','GRAB','GRBK','GRC','GRCL','GREE','GRFS','GRFX','GRI','GRIN','GRMN','GRND','GRNQ','GRNT','GROM','GROV','GROW','GROY','GRPH','GRPN','GRRR','GRTS','GRTX','GRVY','GRWG','GS','GSAT','GSBC','GSBD','GSD','GSHD','GSIT','GSK','GSL','GSM','GSUN','GT','GTAC','GTBP','GTE','GTEC','GTES','GTH','GTHX','GTIM','GTLB','GTLS','GTN','GTN.A','GTX','GTY','GURE','GV','GVA','GVH','GVP','GWAV','GWH','GWRE','GWRS','GWW','GXO','GYRE','GYRO','H','HA','HAE','HAFC','HAIA','HAIN','HAL','HALL','HALO','HARP','HAS','HASI','HAYN','HAYW','HBAN','HBB','HBCP','HBI','HBIO','HBM','HBNC','HBT','HCA','HCAT','HCC','HCDI','HCI','HCKT','HCM','HCMA','HCP','HCSG','HCTI','HCVI','HCWB','HD','HDB','HDSN','HE','HEAR','HEES','HEI','HEI.A','HELE','HEP','HEPA','HEPS','HES','HESM','HFBL','HFFG','HFWA','HG','HGBL','HGTY','HGV','HHGC','HHH','HHLA','HHRS','HHS','HI','HIBB','HIFS','HIG','HIHO','HII','HIMS','HIMX','HIPO','HITI','HIVE','HIW','HKD','HKIT','HL','HLF','HLI','HLIO','HLIT','HLLY','HLMN','HLN','HLNE','HLP','HLT','HLTH','HLVX','HLX','HMC','HMN','HMNF','HMST','HMY','HNI','HNNA','HNRA','HNRG','HNST','HNVR','HOFT','HOFV','HOG','HOLI','HOLO','HOLX','HOMB','HON','HONE','HOOD','HOOK','HOPE','HOTH','HOUR','HOUS','HOV','HOWL','HP','HPCO','HPE','HPK','HPP','HPQ','HQI','HQY','HR','HRB','HRI','HRL','HRMY','HROW','HRT','HRTG','HRTX','HRYU','HRZN','HSAI','HSBC','HSCS','HSDT','HSHP','HSIC','HSII','HSON','HSPO','HST','HSTM','HSY','HT','HTBI','HTBK','HTCR','HTGC','HTH','HTHT','HTLD','HTLF','HTOO','HTZ','HUBB','HUBC','HUBG','HUBS','HUDA','HUDI','HUGE','HUIZ','HUM','HUMA','HUN','HURC','HURN','HUSA','HUT','HUYA','HVT','HWBK','HWC','HWEL','HWKN','HWM','HXL','HY','HYAC','HYFM','HYLN','HYMC','HYPR','HYW','HYZN','HZO','IAC','IAG','IART','IAS','IAUX','IBCP','IBEX','IBIO','IBKR','IBM','IBN','IBOC','IBP','IBRX','IBTX','ICAD','ICCC','ICCH','ICCM','ICCT','ICD','ICE','ICFI','ICG','ICHR','ICL','ICLK','ICLR','ICMB','ICU','ICUI','ICVX','ID','IDA','IDAI','IDCC','IDEX','IDN','IDR','IDT','IDXX','IDYA','IE','IEP','IESC','IEX','IFBD','IFF','IFIN','IFRX','IFS','IGC','IGIC','IGMS','IGT','IGTA','IH','IHG','IHRT','IHS','IHT','III','IIIN','IIIV','IINN','IIPR','IKNA','IKT','ILAG','ILMN','ILPT','IMAB','IMAQ','IMAX','IMCC','IMCR','IMGN','IMKTA','IMMP','IMMR','IMMX','IMNM','IMNN','IMO','IMOS','IMPL','IMPP','IMRN','IMRX','IMTE','IMTX','IMUX','IMVT','IMXI','INAB','INAQ','INBK','INBS','INBX','INCR','INCY','INDB','INDI','INDO','INDP','INDV','INFA','INFN','INFU','INFY','ING','INGN','INGR','INKT','INLX','INM','INMB','INMD','INN','INNV','INO','INOD','INPX','INSE','INSG','INSM','INSP','INST','INSW','INTA','INTC','INTE','INTG','INTR','INTS','INTT','INTU','INTZ','INUV','INVA','INVE','INVH','INVO','INVZ','INZY','IOAC','IOBT','IONM','IONQ','IONR','IONS','IOR','IOSP','IOT','IOVA','IP','IPA','IPAR','IPDN','IPG','IPGP','IPHA','IPI','IPSC','IPVF','IPW','IPWR','IPX','IPXX','IQ','IQV','IR','IRAA','IRBT','IRDM','IREN','IRIX','IRM','IRMD','IRON','IROQ','IRRX','IRS','IRT','IRTC','IRWD','ISDR','ISPC','ISPO','ISPR','ISRG','ISRL','ISSC','ISTR','ISUN','IT','ITCI','ITCL','ITGR','ITI','ITIC','ITOS','ITP','ITRG','ITRI','ITRM','ITRN','ITT','ITUB','ITW','IVA','IVAC','IVCA','IVCB','IVCP','IVDA','IVP','IVR','IVT','IVVD','IVZ','IX','IXAQ','IXHL','IZEA','IZM','J','JACK','JAGX','JAKK','JAMF','JAN','JANX','JAQC','JAZZ','JBGS','JBHT','JBI','JBL','JBLU','JBSS','JBT','JCI','JCSE','JCTCF','JD','JEF','JELD','JEWL','JFBR','JFIN','JFU','JG','JHG','JHX','JILL','JJSF','JKHY','JKS','JLL','JMIA','JMSB','JNJ','JNPR','JNVR','JOAN','JOB','JOBY','JOE','JOUT','JPM','JRSH','JRVR','JSPR','JT','JTAI','JVA','JWEL','JWN','JWSM','JXJT','JXN','JYD','JYNT','JZ','JZXN','K','KA','KACL','KAI','KALA','KALU','KALV','KAMN','KAR','KARO','KAVL','KB','KBH','KBR','KC','KCGI','KD','KDP','KE','KELYA','KELYB','KEN','KEP','KEQU','KERN','KEX','KEY','KEYS','KFFB','KFRC','KFS','KFY','KGC','KGEI','KGS','KHC','KIDS','KIM','KIND','KINS','KIQ','KIRK','KITT','KKR','KLAC','KLG','KLIC','KLTR','KLXE','KMB','KMDA','KMI','KMPR','KMT','KMX','KN','KNDI','KNF','KNOP','KNSA','KNSL','KNSW','KNTE','KNTK','KNW','KNX','KO','KOD','KODK','KOF','KOP','KOPN','KORE','KOS','KOSS','KPLT','KPRX','KPTI','KR','KRC','KREF','KRG','KRKR','KRMD','KRNL','KRNT','KRNY','KRO','KRON','KROS','KRP','KRRO','KRT','KRTX','KRUS','KRYS','KSCP','KSS','KT','KTB','KTCC','KTOS','KTRA','KTTA','KUKE','KULR','KURA','KVAC','KVHI','KVSA','KVUE','KVYO','KW','KWE','KWR','KXIN','KYCH','KYMR','KZIA','KZR','L','LAAC','LAB','LABP','LAC','LAD','LADR','LAES','LAKE','LAMR','LANC','LAND','LANV','LARK','LASE','LASR','LATG','LAUR','LAW','LAZ','LAZR','LAZY','LBAI','LBBB','LBC','LBPH','LBRDA','LBRDK','LBRT','LBTYA','LBTYB','LBTYK','LC','LCA','LCAA','LCFY','LCID','LCII','LCNB','LCTX','LCUT','LCW','LDI','LDOS','LDWY','LE','LEA','LECO','LEDS','LEE','LEG','LEGH','LEGN','LEJU','LEN','LEN.B','LESL','LEU','LEV','LEVI','LEXX','LFCR','LFLY','LFMD','LFST','LFT','LFUS','LFVN','LGF.A','LGF.B','LGHL','LGIH','LGL','LGMK','LGND','LGO','LGST','LGVC','LGVN','LH','LHC','LHX','LI','LIAN','LIBY','LICN','LICY','LIDR','LIFE','LIFW','LII','LILA','LILAK','LILM','LIN','LINC','LIND','LINK','LIPO','LIQT','LITB','LITE','LITM','LIVB','LIVE','LIVN','LIXT','LIZI','LKCO','LKFN','LKQ','LL','LLAP','LLY','LMAT','LMB','LMDX','LMFA','LMND','LMNR','LMT','LNC','LND','LNG','LNKB','LNN','LNSR','LNT','LNTH','LNW','LNZA','LOAN','LOB','LOCC','LOCL','LOCO','LODE','LOGI','LOMA','LOOP','LOPE','LOVE','LOW','LPCN','LPG','LPL','LPLA','LPRO','LPSN','LPTH','LPTV','LPTX','LPX','LQDA','LQDT','LQR','LRCX','LRE','LRFC','LRHC','LRMR','LRN','LSAK','LSBK','LSCC','LSDI','LSEA','LSF','LSPD','LSTA','LSTR','LTBR','LTC','LTH','LTHM','LTRN','LTRX','LTRY','LU','LUCD','LUCY','LULU','LUMN','LUMO','LUNA','LUNG','LUNR','LUV','LUXH','LVLU','LVO','LVOX','LVRO','LVS','LVTX','LVWR','LW','LWAY','LWLG','LX','LXEH','LXEO','LXFR','LXP','LXRX','LXU','LYB','LYEL','LYFT','LYG','LYRA','LYT','LYTS','LYV','LZ','LZB','LZM','M','MA','MAA','MAC','MACA','MACK','MAG','MAIA','MAIN','MAMA','MAN','MANH','MANU','MAPS','MAQC','MAR','MARA','MARK','MARPS','MARX','MAS','MASI','MASS','MAT','MATH','MATV','MATW','MATX','MAX','MAXN','MAYS','MBAC','MBC','MBCN','MBI','MBIN','MBIO','MBLY','MBOT','MBRX','MBTC','MBUU','MBWM','MC','MCAA','MCAC','MCAF','MCAG','MCB','MCBC','MCBS','MCD','MCFT','MCHP','MCHX','MCK','MCO','MCOM','MCRB','MCRI','MCS','MCVT','MCW','MCY','MD','MDAI','MDB','MDBH','MDC','MDGL','MDGS','MDIA','MDJH','MDLZ','MDRR','MDRX','MDT','MDU','MDV','MDVL','MDWD','MDWT','MDXG','MDXH','ME','MEC','MED','MEDP','MEDS','MEG','MEGL','MEI','MEIP','MELI','MEOH','MERC','MESA','MESO','MET','META','METC','METCB','MFA','MFC','MFG','MFH','MFIC','MFIN','MG','MGA','MGAM','MGEE','MGIC','MGIH','MGLD','MGM','MGNI','MGNX','MGOL','MGPI','MGRC','MGRM','MGRX','MGTX','MGY','MGYR','MHH','MHK','MHLD','MHO','MHUA','MI','MICS','MIDD','MIGI','MIMO','MIND','MINM','MIR','MIRA','MIRM','MIRO','MIST','MITA','MITK','MITQ','MITT','MIXT','MKC','MKFG','MKL','MKSI','MKTW','MKTX','ML','MLAB','MLCO','MLEC','MLGO','MLI','MLKN','MLM','MLNK','MLP','MLR','MLSS','MLTX','MLYS','MMAT','MMC','MMI','MMLP','MMM','MMS','MMSI','MMV','MMYT','MNDO','MNDY','MNKD','MNMD','MNOV','MNPR','MNR','MNRO','MNSB','MNSO','MNST','MNTK','MNTN','MNTS','MNTX','MNY','MO','MOB','MOBQ','MOBV','MOD','MODD','MODG','MODN','MODV','MOFG','MOG.A','MOG.B','MOGO','MOGU','MOH','MOLN','MOMO','MOND','MOR','MORF','MORN','MOS','MOTS','MOV','MOVE','MP','MPAA','MPB','MPC','MPLN','MPLX','MPTI','MPU','MPW','MPWR','MPX','MQ','MRAI','MRAM','MRBK','MRC','MRCC','MRCY','MRDB','MREO','MRIN','MRK','MRKR','MRM','MRNA','MRNS','MRO','MRSN','MRT','MRTN','MRTX','MRUS','MRVI','MRVL','MS','MSA','MSB','MSBI','MSC','MSCI','MSEX','MSFT','MSGE','MSGM','MSGS','MSI','MSM','MSN','MSS','MSSA','MSTR','MT','MTA','MTAL','MTB','MTBL','MTC','MTCH','MTD','MTDR','MTEK','MTEM','MTEX','MTG','MTH','MTLS','MTN','MTNB','MTR','MTRN','MTRX','MTRY','MTSI','MTTR','MTW','MTX','MTZ','MU','MUFG','MULN','MUR','MURA','MUSA','MUX','MVBF','MVIS','MVLA','MVST','MWA','MWG','MX','MXC','MXCT','MXL','MYE','MYFW','MYGN','MYMD','MYNA','MYNZ','MYO','MYPS','MYRG','MYSZ','MYTE','nan','NAAS','NABL','NAII','NAK','NAMS','NAOV','NAPA','NARI','NAT','NATH','NATL','NATR','NAUT','NAVI','NB','NBHC','NBIX','NBN','NBR','NBSE','NBST','NBTB','NBTX','NBY','NC','NCAC','NCL','NCLH','NCMI','NCNA','NCNC','NCNO','NCPL','NCRA','NCSM','NCTY','NDAQ','NDLS','NDRA','NDSN','NE','NECB','NEE','NEGG','NEM','NEN','NEO','NEOG','NEON','NEOV','NEP','NEPH','NEPT','NERV','NET','NETC','NETD','NETI','NEU','NEWP','NEWT','NEXA','NEXI','NEXT','NFBK','NFE','NFG','NFGC','NFLX','NFTG','NFYS','NG','NGD','NGG','NGL','NGM','NGMS','NGS','NGVC','NGVT','NHC','NHI','NHTC','NHWK','NI','NIC','NICE','NICK','NINE','NIO','NIR','NISN','NIU','NJR','NKE','NKGN','NKLA','NKSH','NKTR','NKTX','NL','NLOP','NLSP','NLTX','NLY','NM','NMFC','NMG','NMIH','NMM','NMR','NMRA','NMRD','NMRK','NMTC','NN','NNAG','NNBR','NNDM','NNI','NNN','NNOX','NNVC','NOA','NOAH','NOC','NODK','NOG','NOGN','NOK','NOMD','NOTE','NOTV','NOV','NOVA','NOVT','NOVV','NOW','NPAB','NPCE','NPK','NPO','NPWR','NR','NRAC','NRBO','NRC','NRDS','NRDY','NREF','NRG','NRGV','NRIM','NRIX','NRP','NRSN','NRT','NRXP','NRXS','NS','NSA','NSC','NSIT','NSP','NSPR','NSSC','NSTB','NSTG','NSTS','NSYS','NTAP','NTB','NTBL','NTCO','NTCT','NTES','NTGR','NTIC','NTIP','NTLA','NTNX','NTR','NTRA','NTRB','NTRS','NTST','NTWK','NTZ','NU','NUBI','NUE','NURO','NUS','NUTX','NUVB','NUVL','NUWE','NUZE','NVAC','NVAX','NVCR','NVCT','NVDA','NVEC','NVEE','NVEI','NVFY','NVGS','NVIV','NVMI','NVNI','NVNO','NVO','NVOS','NVR','NVRI','NVRO','NVS','NVST','NVT','NVTA','NVTS','NVVE','NVX','NWBI','NWE','NWFL','NWG','NWGL','NWL','NWLI','NWN','NWPX','NWS','NWSA','NWTN','NX','NXE','NXGL','NXL','NXPI','NXPL','NXRT','NXST','NXT','NXTC','NXTP','NXU','NYAX','NYC','NYCB','NYMT','NYT','NYXH','O','OABI','OAKU','OB','OBDC','OBE','OBIO','OBK','OBLG','OBT','OC','OCAX','OCC','OCEA','OCFC','OCFT','OCG','OCGN','OCN','OCS','OCSL','OCTO','OCUL','OCUP','OCX','ODC','ODD','ODFL','ODP','ODV','OEC','OESX','OFG','OFIX','OFLX','OFS','OGE','OGEN','OGI','OGN','OGS','OHAA','OHI','OI','OII','OIS','OKE','OKTA','OKYO','OLB','OLED','OLK','OLLI','OLMA','OLN','OLO','OLP','OLPX','OM','OMAB','OMC','OMCL','OMER','OMEX','OMF','OMGA','OMH','OMI','OMIC','OMQS','ON','ONB','ONCT','ONCY','ONDS','ONEW','ONFO','ONL','ONMD','ONON','ONTF','ONTO','ONTX','ONVO','ONYX','OOMA','OP','OPA','OPAD','OPAL','OPBK','OPCH','OPEN','OPFI','OPGN','OPHC','OPI','OPK','OPOF','OPRA','OPRT','OPRX','OPT','OPTN','OPTT','OPTX','OPXS','OPY','OR','ORA','ORAN','ORC','ORCL','ORGN','ORGO','ORGS','ORI','ORIC','ORLA','ORLY','ORMP','ORN','ORRF','ORTX','OSA','OSBC','OSCR','OSG','OSI','OSIS','OSK','OSPN','OSS','OST','OSUR','OSW','OTEC','OTEX','OTIS','OTLK','OTLY','OTRK','OTTR','OUST','OUT','OVBC','OVID','OVLY','OVV','OWL','OWLT','OXBR','OXM','OXSQ','OXUS','OXY','OZ','OZK','PAAS','PAC','PACB','PACI','PACK','PACW','PAG','PAGP','PAGS','PAHC','PALI','PALT','PAM','PANL','PANW','PAPL','PAR','PARA','PARAA','PARR','PASG','PATH','PATI','PATK','PAVM','PAVS','PAX','PAY','PAYC','PAYO','PAYS','PAYX','PB','PBA','PBAX','PBBK','PBF','PBFS','PBH','PBHC','PBI','PBLA','PBPB','PBR','PBR.A','PBT','PBTS','PBYI','PCAR','PCB','PCCT','PCG','PCH','PCOR','PCRX','PCSA','PCT','PCTI','PCTY','PCVX','PCYO','PD','PDCO','PDD','PDEX','PDFS','PDLB','PDM','PDS','PDSB','PEAK','PEB','PEBK','PEBO','PECO','PED','PEG','PEGA','PEGR','PEGY','PEN','PENN','PEP','PEPG','PEPL','PERF','PERI','PESI','PET','PETQ','PETS','PETV','PETZ','PEV','PFBC','PFC','PFE','PFG','PFGC','PFIE','PFIN','PFIS','PFLT','PFMT','PFS','PFSI','PFTA','PFX','PG','PGC','PGEN','PGNY','PGR','PGRE','PGRU','PGSS','PGTI','PGY','PH','PHAR','PHAT','PHG','PHGE','PHI','PHIN','PHIO','PHM','PHR','PHUN','PHVS','PHX','PHXM','PHYT','PI','PII','PIII','PIK','PINC','PINE','PINS','PIPR','PIRS','PIXY','PJT','PK','PKBK','PKE','PKG','PKOH','PKX','PL','PLAB','PLAG','PLAO','PLAY','PLBC','PLBY','PLCE','PLD','PLG','PLL','PLMI','PLMR','PLNT','PLOW','PLPC','PLRX','PLSE','PLTK','PLTN','PLTR','PLUG','PLUR','PLUS','PLX','PLXS','PLYA','PLYM','PM','PMCB','PMD','PMEC','PMN','PMT','PMTS','PMVP','PNBK','PNC','PNFP','PNM','PNNT','PNR','PNRG','PNT','PNTG','PNW','POAI','POCI','PODC','PODD','POET','POL','POLA','POOL','POR','PORT','POST','POWI','POWL','POWW','PPBI','PPBT','PPC','PPG','PPHP','PPIH','PPL','PPSI','PPTA','PPYA','PR','PRA','PRAA','PRAX','PRCH','PRCT','PRDO','PRE','PRFT','PRFX','PRG','PRGO','PRGS','PRI','PRIM','PRK','PRLB','PRLD','PRLH','PRM','PRME','PRMW','PRO','PROC','PROF','PROK','PROV','PRPH','PRPL','PRPO','PRQR','PRSO','PRSR','PRST','PRT','PRTA','PRTC','PRTG','PRTH','PRTS','PRU','PRVA','PRZO','PSA','PSEC','PSFE','PSHG','PSMT','PSN','PSNL','PSNY','PSO','PSQH','PSTG','PSTL','PSTV','PSTX','PSX','PT','PTC','PTCT','PTEN','PTGX','PTHR','PTIX','PTLO','PTMN','PTN','PTON','PTPI','PTRS','PTSI','PTVE','PTWO','PUBM','PUCK','PUK','PULM','PUMP','PUYI','PVBC','PVH','PVL','PW','PWFL','PWM','PWOD','PWP','PWR','PWSC','PWUP','PX','PXD','PXDT','PXLW','PXMD','PXS','PYCR','PYPD','PYPL','PYXS','PZG','PZZA','QBTS','QCOM','QCRH','QD','QDEL','QDRO','QETA','QFIN','QFTA','QGEN','QH','QIPT','QLGN','QLI','QLYS','QMCO','QNCX','QNRX','QNST','QOMO','QRHC','QRTEA','QRTEB','QRVO','QS','QSG','QSI','QSR','QTRX','QTWO','QUAD','QUBT','QUIK','QURE','R','RACE','RACY','RAIL','RAIN','RAMP','RAND','RANI','RAPT','RARE','RAVE','RAYA','RBA','RBB','RBBN','RBC','RBCAA','RBKB','RBLX','RBOT','RBT','RC','RCAC','RCAT','RCEL','RCFA','RCI','RCKT','RCKY','RCL','RCM','RCMT','RCON','RCRT','RCUS','RDCM','RDFN','RDHL','RDI','RDIB','RDN','RDNT','RDUS','RDVT','RDW','RDWR','RDY','RDZN','REAL','REAX','REBN','REE','REFI','REFR','REG','REGN','REI','REKR','RELI','RELL','RELX','RELY','RENB','RENE','RENT','REPL','REPX','RERE','RES','RETO','REVB','REVG','REX','REXR','REYN','REZI','RF','RFAC','RFIL','RFL','RGA','RGC','RGCO','RGEN','RGF','RGLD','RGLS','RGNX','RGP','RGR','RGS','RGTI','RH','RHE','RHI','RHP','RICK','RIG','RIGL','RILY','RIO','RIOT','RITM','RIVN','RJF','RKDA','RKLB','RKT','RL','RLAY','RLGT','RLI','RLJ','RLMD','RLX','RLYB','RM','RMAX','RMBI','RMBL','RMBS','RMCF','RMCO','RMD','RMGC','RMNI','RMR','RMTI','RNA','RNAC','RNAZ','RNG','RNGR','RNLX','RNR','RNST','RNW','RNXT','ROAD','ROCK','ROCL','ROG','ROI','ROIC','ROIV','ROK','ROKU','ROL','ROOT','ROP','ROSE','ROSS','ROST','ROVR','RPAY','RPD','RPHM','RPID','RPM','RPRX','RPT','RPTX','RR','RRAC','RRBI','RRC','RRGB','RRR','RRX','RS','RSG','RSI','RSKD','RSLS','RSSS','RSVR','RTC','RTO','RTX','RUM','RUN','RUSHA','RUSHB','RVLV','RVMD','RVNC','RVP','RVPH','RVSB','RVSN','RVTY','RVYL','RWAY','RWLK','RWOD','RWT','RXO','RXRX','RXST','RXT','RY','RYAAY','RYAM','RYAN','RYI','RYN','RYTM','RYZB','RZLT','S','SA','SABR','SABS','SACH','SAFE','SAFT','SAGA','SAGE','SAH','SAI','SAIA','SAIC','SALM','SAM','SAMG','SAN','SANA','SAND','SANG','SANM','SANW','SAP','SAR','SASI','SASR','SATL','SATS','SATX','SAVA','SAVE','SB','SBAC','SBCF','SBET','SBEV','SBFG','SBFM','SBGI','SBH','SBLK','SBOW','SBR','SBRA','SBS','SBSI','SBSW','SBT','SBUX','SBXC','SCCO','SCHL','SCHW','SCI','SCKT','SCL','SCLX','SCM','SCNI','SCOR','SCPH','SCRM','SCS','SCSC','SCTL','SCVL','SCWO','SCWX','SCX','SCYX','SD','SDA','SDGR','SDIG','SDOT','SDPI','SDRL','SE','SEAS','SEAT','SEB','SECO','SEDA','SEDG','SEE','SEED','SEEL','SEER','SEIC','SELF','SEM','SEMR','SENEA','SENEB','SENS','SEPA','SERA','SES','SEVN','SEZL','SF','SFBC','SFBS','SFE','SFIX','SFL','SFM','SFNC','SFST','SFWL','SG','SGA','SGBX','SGC','SGD','SGE','SGEN','SGH','SGHC','SGHT','SGII','SGLY','SGMA','SGML','SGMO','SGMT','SGN','SGRP','SGRY','SGU','SHAK','SHAP','SHBI','SHC','SHCO','SHCR','SHEL','SHEN','SHFS','SHG','SHIM','SHIP','SHLS','SHLT','SHO','SHOO','SHOP','SHOT','SHPH','SHPW','SHW','SHYF','SIBN','SID','SIDU','SIEB','SIEN','SIF','SIFY','SIG','SIGA','SIGI','SII','SILC','SILK','SILO','SILV','SIM','SIMO','SINT','SIRI','SISI','SITC','SITE','SITM','SIX','SJ','SJM','SJT','SJW','SKE','SKGR','SKIL','SKIN','SKLZ','SKM','SKT','SKWD','SKX','SKY','SKYH','SKYT','SKYW','SKYX','SLAB','SLAC','SLAM','SLB','SLCA','SLDB','SLDP','SLE','SLF','SLG','SLGC','SLGL','SLGN','SLI','SLM','SLN','SLNA','SLND','SLNG','SLNH','SLNO','SLP','SLQT','SLRC','SLRN','SLRX','SLS','SLVM','SM','SMAP','SMAR','SMBC','SMBK','SMCI','SMFG','SMFL','SMG','SMID','SMLP','SMLR','SMMF','SMMT','SMP','SMPL','SMR','SMRT','SMSI','SMTC','SMTI','SMWB','SMX','SN','SNA','SNAL','SNAP','SNAX','SNBR','SNCE','SNCR','SNCY','SND','SNDA','SNDL','SNDR','SNDX','SNES','SNEX','SNFCA','SNGX','SNN','SNOA','SNOW','SNPO','SNPS','SNPX','SNSE','SNT','SNTG','SNTI','SNV','SNX','SNY','SO','SOBR','SOFI','SOFO','SOHO','SOHU','SOI','SOL','SOLO','SON','SOND','SONM','SONN','SONO','SONX','SONY','SOPA','SOPH','SOS','SOTK','SOUN','SOVO','SP','SPB','SPCB','SPCE','SPEC','SPFI','SPG','SPGC','SPGI','SPH','SPHR','SPI','SPIR','SPKL','SPLK','SPLP','SPNS','SPNT','SPOK','SPOT','SPPL','SPR','SPRB','SPRC','SPRO','SPRU','SPRY','SPSC','SPT','SPTN','SPWH','SPWR','SPXC','SQ','SQFT','SQM','SQNS','SQSP','SR','SRAD','SRBK','SRC','SRCE','SRCL','SRDX','SRE','SRFM','SRG','SRI','SRL','SRM','SRPT','SRRK','SRT','SRTS','SRZN','SSB','SSBI','SSBK','SSD','SSIC','SSKN','SSL','SSNC','SSNT','SSP','SSRM','SSSS','SST','SSTI','SSTK','SSY','SSYS','ST','STAA','STAF','STAG','STBA','STBX','STC','STCN','STE','STEL','STEM','STEP','STER','STG','STGW','STHO','STIM','STIX','STKH','STKL','STKS','STLA','STLD','STM','STN','STNE','STNG','STOK','STR','STRA','STRC','STRL','STRM','STRO','STRR','STRS','STRT','STRW','STSS','STT','STTK','STVN','STWD','STX','STXS','STZ','SU','SUAC','SUI','SUM','SUN','SUNW','SUP','SUPN','SUPV','SURG','SUZ','SVC','SVFD','SVII','SVM','SVRA','SVRE','SVT','SVV','SWAG','SWAV','SWBI','SWI','SWIM','SWIN','SWK','SWKH','SWKS','SWN','SWSS','SWTX','SWVL','SWX','SXC','SXI','SXT','SXTC','SXTP','SY','SYBT','SYBX','SYF','SYK','SYM','SYNA','SYPR','SYRA','SYRS','SYT','SYTA','SYY','SZZL','T','TAC','TACT','TAIT','TAK','TAL','TALK','TALO','TANH','TAOP','TAP','TARA','TARO','TARS','TASK','TAST','TATT','TAYD','TBBK','TBCP','TBI','TBIO','TBLA','TBLT','TBMC','TBNK','TBPH','TC','TCBC','TCBI','TCBK','TCBP','TCBS','TCBX','TCI','TCJH','TCMD','TCN','TCOA','TCOM','TCON','TCPC','TCRT','TCRX','TCS','TCX','TD','TDC','TDCX','TDG','TDOC','TDS','TDUP','TDW','TDY','TEAM','TECH','TECK','TEDU','TEF','TEL','TELA','TELL','TENB','TENK','TENX','TEO','TER','TERN','TETE','TEVA','TEX','TFC','TFFP','TFII','TFIN','TFPM','TFSL','TFX','TG','TGAA','TGAN','TGB','TGH','TGI','TGL','TGLS','TGNA','TGS','TGT','TGTX','TGVC','TH','THAR','THC','THCH','THCP','THFF','THG','THM','THMO','THO','THR','THRD','THRM','THRX','THRY','THS','THTX','TIGO','TIGR','TIL','TILE','TIMB','TIO','TIPT','TIRX','TISI','TITN','TIVC','TIXT','TJX','TK','TKC','TKLF','TKNO','TKO','TKR','TLF','TLGY','TLIS','TLK','TLRY','TLS','TLSA','TLSI','TLYS','TM','TMBR','TMC','TMCI','TMDX','TME','TMHC','TMO','TMP','TMQ','TMST','TMTC','TMUS','TNC','TNDM','TNET','TNGX','TNK','TNL','TNON','TNP','TNXP','TNYA','TOI','TOL','TOMZ','TOON','TOP','TOPS','TORO','TOST','TOUR','TOVX','TOWN','TPB','TPC','TPET','TPG','TPH','TPHS','TPIC','TPL','TPR','TPST','TPVG','TPX','TR','TRAK','TRC','TRDA','TREE','TREX','TRGP','TRI','TRIB','TRIN','TRIP','TRIS','TRKA','TRMB','TRMD','TRMK','TRML','TRMR','TRN','TRNO','TRNR','TRNS','TRON','TROO','TROW','TROX','TRP','TRS','TRST','TRT','TRTL','TRTX','TRU','TRUE','TRUP','TRV','TRVG','TRVI','TRVN','TRX','TS','TSAT','TSBK','TSBX','TSCO','TSE','TSEM','TSHA','TSLA','TSLX','TSM','TSN','TSP','TSQ','TSRI','TSVT','TT','TTC','TTD','TTE','TTEC','TTEK','TTGT','TTI','TTMI','TTNP','TTOO','TTSH','TTWO','TU','TUP','TURB','TURN','TUSK','TUYA','TV','TVTX','TW','TWI','TWIN','TWKS','TWLO','TWLV','TWO','TWOA','TWOU','TWST','TX','TXG','TXMD','TXN','TXO','TXRH','TXT','TYG','TYGO','TYL','TYRA','TZOO','U','UA','UAA','UAL','UAMY','UAN','UAVS','UBCP','UBER','UBFO','UBS','UBSI','UBX','UCAR','UCBI','UCL','UCTT','UDMY','UDR','UE','UEC','UEIC','UFCS','UFI','UFPI','UFPT','UG','UGI','UGP','UGRO','UHAL','UHAL.B','UHG','UHS','UHT','UI','UIS','UK','UL','ULBI','ULCC','ULH','ULTA','ULY','UMBF','UMC','UMH','UNB','UNCY','UNF','UNFI','UNH','UNIT','UNM','UNP','UNTY','UONE','UONEK','UP','UPBD','UPC','UPH','UPLD','UPS','UPST','UPWK','UPXI','URBN','URG','URGN','URI','UROY','USAC','USAP','USAS','USAU','USB','USCB','USCT','USEA','USEG','USFD','USGO','USIO','USLM','USM','USNA','USPH','UTHR','UTI','UTL','UTMD','UTRS','UTSI','UTZ','UUU','UUUU','UVE','UVSP','UVV','UWMC','UXIN','V','VABK','VAC','VAL','VALE','VALN','VALU','VANI','VAPO','VAQC','VATE','VAXX','VBFC','VBIV','VBNK','VBTX','VC','VCEL','VCIG','VCNX','VCSA','VCTR','VCXA','VCXB','VCYT','VECO','VEEE','VEEV','VEL','VEON','VERA','VERB','VERI','VERO','VERU','VERV','VERX','VERY','VET','VEV','VFC','VFF','VFS','VGAS','VGR','VGZ','VHAQ','VHC','VHI','VIA','VIAO','VIAV','VICI','VICR','VIEW','VIGL','VII','VINC','VINE','VINO','VINP','VIOT','VIPS','VIR','VIRC','VIRI','VIRT','VIRX','VISL','VIST','VITL','VIV','VIVK','VJET','VKTX','VLCN','VLD','VLGEA','VLN','VLO','VLRS','VLTO','VLY','VMAR','VMC','VMCA','VMD','VMEO','VMI','VMW','VNCE','VNDA','VNET','VNO','VNOM','VNRX','VNT','VOC','VOD','VOR','VOXR','VOXX','VOYA','VPG','VRA','VRAR','VRAX','VRCA','VRDN','VRE','VREX','VRM','VRME','VRNA','VRNS','VRNT','VRPX','VRRM','VRSK','VRSN','VRT','VRTS','VRTV','VRTX','VS','VSAC','VSAT','VSCO','VSEC','VSH','VSME','VST','VSTA','VSTM','VSTO','VSTS','VTAK','VTEX','VTGN','VTLE','VTMX','VTNR','VTOL','VTR','VTRS','VTRU','VTS','VTSI','VTVT','VTYX','VUZI','VVI','VVOS','VVPR','VVV','VVX','VWE','VXRT','VYGR','VYNE','VYX','VZ','VZIO','VZLA','W','WAB','WABC','WAFD','WAFU','WAL','WALD','WASH','WAT','WATT','WAVD','WAVE','WAVS','WB','WBA','WBD','WBS','WBUY','WBX','WCC','WCN','WD','WDAY','WDC','WDFC','WDH','WDS','WEAV','WEC','WEL','WELL','WEN','WERN','WES','WEST','WETG','WEX','WEYS','WF','WFC','WFCF','WFG','WFRD','WGO','WGS','WH','WHD','WHF','WHG','WHLM','WHLR','WHR','WILC','WIMI','WINA','WING','WINT','WINV','WIRE','WISA','WISH','WIT','WIX','WK','WKC','WKEY','WKHS','WKME','WKSP','WLDN','WLDS','WLFC','WLGS','WLK','WLKP','WLY','WLYB','WM','WMB','WMC','WMG','WMK','WMPN','WMS','WMT','WNC','WNEB','WNNR','WNS','WNW','WOLF','WOOF','WOR','WORX','WOW','WPC','WPM','WPP','WPRT','WRAC','WRAP','WRB','WRBY','WRK','WRLD','WRN','WRNT','WSBC','WSBF','WSC','WSFS','WSM','WSO','WSR','WST','WT','WTBA','WTER','WTFC','WTI','WTM','WTMA','WTO','WTRG','WTS','WTTR','WTW','WU','WULF','WVE','WVVI','WW','WWD','WWR','WWW','WY','WYNN','WYY','X','XAIR','XBIO','XBIT','XCUR','XEL','XELA','XELB','XENE','XERS','XFIN','XFOR','XGN','XHR','XIN','XLO','XMTR','XNCR','XNET','XOM','XOMA','XOS','XP','XPDB','XPEL','XPER','XPEV','XPL','XPO','XPOF','XPON','XPRO','XRAY','XRTX','XRX','XTLB','XTNT','XWEL','XXII','XYF','XYL','YALA','YCBD','YELP','YETI','YEXT','YGF','YGMZ','YHGJ','YI','YJ','YMAB','YMM','YORW','YOSH','YOTA','YOU','YPF','YQ','YRD','YS','YSG','YTEN','YTRA','YUM','YUMC','YY','Z','ZAPP','ZBH','ZBRA','ZCMD','ZD','ZDGE','ZENV','ZEPP','ZETA','ZEUS','ZFOX','ZG','ZGN','ZH','ZI','ZIM','ZIMV','ZION','ZIP','ZIVO','ZJYL','ZKIN','ZLAB','ZLS','ZM','ZNTL','ZOM','ZS','ZTEK','ZTO','ZTS','ZUMZ','ZUO','ZURA','ZVIA','ZVRA','ZVSA','ZWS','ZYME','ZYXI'}


tokenizer = AutoTokenizer.from_pretrained("ProsusAI/finbert")
model = AutoModelForSequenceClassification.from_pretrained("ProsusAI/finbert")

def analyzer(strings):
  ''' Strings: List of articles as strings'''

  def model_predict(input_text):
    inputs = tokenizer(input_text, return_tensors="pt", truncation=True)
    # Forward pass through the model
    outputs = model(**inputs)
    # Get predicted class probabilities
    probabilities = outputs.logits.softmax(dim=1)
    # Get predicted class label
    predicted_class = torch.argmax(probabilities, dim=1).item()

    return probabilities.detach().flatten().numpy(), predicted_class

  pos_total, neg_total, neut_total = 0, 0, 0
  positives = np.zeros(len(strings))
  avg_vector = np.zeros(3)
  all_vectors = []
  for i, string in enumerate(strings):
    probabilities, predicted_class = model_predict(string)

    if predicted_class == 0:
      pos_total += 1
    elif predicted_class == 1:
      neg_total += 1
    else: 
      neut_total += 1
    
    positives[i] = probabilities[0]

    all_vectors.append(probabilities.tolist())

    avg_vector += probabilities

  avg_vector = (avg_vector / len(strings))
  std_deviation = np.std(positives)
  avg_vector = [round(x, 2) for x in avg_vector.tolist()]
  overall_prediction = max([[x, i] for i, x in enumerate(avg_vector)])[1]
  std_round = round(std_deviation, 3)

  return {'overall_pred': overall_prediction, 'std': std_round, 'avg_vector': avg_vector, 'num_pos': pos_total, 'num_neg': neg_total, 'num_neut': neut_total, 'pos_prob': avg_vector[0], 'neg_prob': avg_vector[1], 'neut_prob': avg_vector[2], 'all_vectors': all_vectors}


def search_links(tics):
    tics_upper = tics.upper()
    print(f"preupper: {tics}")
    print(f"postupper: {tics_upper}")
    if (tics_upper in nasdaq_ticker_set):
        ticker_name = yf.Ticker(tics)
        ticker_name = ticker_name.news
        links = []
        titles = []
        for i in ticker_name:
            links.append(i['link'])
            titles.append(i['title'])
        url = f"https://news.google.com/search?q='{tics}'%20stock%20news+when:7d&ceid=US:en&hl=en-US&gl=US"

        # Online parsing
        page = requests.get(url).text

        # Create an object to scrape various data later
        soup = BeautifulSoup(page, 'html.parser')

        # Title
        result_tl = soup.select('article .DY5T1d.RZIKme')
        titles1 = [t.text for t in result_tl]
        for t in titles1:
            titles.append(t)

        for index, names in enumerate(titles):
            if len(names) >= 55:
                titles[index] = names[0:55]
        return links

    else:
        print(f"Invalid ticker: {tics}")
        return None



def textScrape(link):
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'}
    try:
        page = requests.get(link, headers=headers)
        page.raise_for_status()
    except requests.exceptions.HTTPError as err:
        raise SystemExit(err)

    soupafied = BeautifulSoup(page.text, 'html.parser')
    divs = soupafied.find_all('div', class_="caas-body")

    finText = ""
    for div in divs:
        paragraphs = div.find_all('p')
        for paragraph in paragraphs:
            finText += paragraph.get_text()
    return finText


def scrape_google(tic):
  tic_upper = tic.upper()
  if tic_upper in nasdaq_ticker_set:
      # Create a Google News search URL
      google_news_url = f"https://news.google.com/search?q='{tic_upper}'%20stock%20news+when:7d&ceid=US:en&hl=en-US&gl=US"

      # Online parsing with headers and sleep
      headers = {'User-Agent': 'Your-User-Agent-Here'}
      page = requests.get(google_news_url, headers=headers).text
      time.sleep(0.5)  # Sleep for 0.5 seconds to avoid rapid requests

      # Create an object to scrape various data later
      soup = BeautifulSoup(page, 'html.parser')

      # Extract links from Google News
      base_url = 'https://news.google.com/'
      links_from_google_news = [urljoin(base_url, i.get('href')) for i in soup.select('article .DY5T1d.RZIKme')]

      body_texts = set()
      for index, link in enumerate(links_from_google_news):
          #if index > 30:
          if index > 2:
            break
          # Use Newspaper3k to get article information
          article = Article(link)
          try:
              article.download()
              article.parse()

              # Extract relevant information from the article
              body_texts.add(article.text)
          except Exception as e:
              continue

      return list(body_texts)

def textScrapeAll(tic):
    links = search_links(tic)
    if links == None:
        return None
    i = 0
    textList = [""] * len(links)
    while(i<len(links)):
        textList[i] = textScrape(links[i])
        i += 1

    extra_text = scrape_google(tic)
    if extra_text:
        textList.extend(extra_text)

    return textList